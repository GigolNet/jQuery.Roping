/*
 * jQuery
 * @copyright : GigolNet
 * @author : Ilia GUIGOLACHVILI
 * @web : http://gigol.net
 * @plugin : Roping
 * @version : 1.0.0
 * Last modified : 23/01/2015
 */
(function(a){a.fn.roping=function(f){var j=this;var i,h;var d,e,s,b;var r,o,q,p,g,m;var c=a.extend({shepherd:a("#shepherd"),shepherd_x:0,shepherd_y:0,sheep_x:0,sheep_y:0,rope_width:1,rope_color:"black",rope_cap:"round"},f);var k=a('<canvas id="rope">Your browser does not support the HTML5 canvas tag.</canvas>').appendTo("body");var n=a(k).get(0).getContext("2d");var l=false;a(document).on("mousedown",function(t){l=true});a(document).on("mouseup",function(t){l=false});a(document).on("mousemove",function(v){if(l){s=c.shepherd.offset().left;b=c.shepherd.offset().top;e=c.shepherd.width();d=c.shepherd.height();i=j.offset().left;h=j.offset().top;r=(s+c.shepherd_x);o=(b+d+c.shepherd_y);p=(i+c.sheep_x);q=(h+c.sheep_y);g=parseInt(i-r);m=parseInt(h-o);var u=2*g-r/2-i/2;var t=2*m-o/2-h/2;var x=(i+c.sheep_x);var w=(h+c.sheep_y);if(p<=r){p=r}if(q<=o){q=o}k.attr("height",q);k.attr("width",p);k.css({position:"absolute",left:0,top:0,overflow:"none",margin:0,padding:0});n.clearRect(0,0,k.width,k.height);n.beginPath();n.moveTo(r,o);n.quadraticCurveTo(u,t,x,w);n.lineWidth=c.rope_width;n.lineCap=c.rope_cap;n.strokeStyle=c.rope_color;n.stroke()}})}}(jQuery));